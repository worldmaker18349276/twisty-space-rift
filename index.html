<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Space Rift Intersecting Circle Puzzles</title>
  <script async defer src="https://buttons.github.io/buttons.js"></script>
  <script type="module">
    import {SpaceRiftPuzzle} from "./build/SpaceRiftPuzzle.js";

    let puzzle = undefined;
    function load(variant) {
      if (puzzle !== undefined) {
        puzzle.deinit();
      }
      const canvas = document.getElementById("main");
      puzzle = SpaceRiftPuzzle.make(variant, canvas);
      if (puzzle !== undefined) {
        document.title = puzzle.name;
        puzzle.init();
        console.log(puzzle);
      }
    }
    window.addEventListener("load", () => load(window.location.hash.slice(1) || "D2H"));
    window.addEventListener("hashchange", () => load(window.location.hash.slice(1)));
  </script>

  <style>
    @media (prefers-color-scheme: light) {
      :root {
        --font-color: #333;
        --inactive-color: #ddd;
        --hover-color: #bbb;
        --active-color: #eee;
        --background-color: #eee;
      }
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --font-color: #ddd;
        --inactive-color: #333;
        --hover-color: #555;
        --active-color: #222;
        --background-color: #222;
      }
    }

    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: var(--background-color);
    }

    ul.tab-list {
      list-style-type: none;
      margin: 0;
      padding: 0;
      display: flex;
      overflow: hidden;
      background-color: var(--inactive-color);
    }

    ul.tab-list a {
      display: block;
      padding: 5px 10px;
      text-decoration: none;
      text-wrap: nowrap;
      color: var(--font-color);
      background-color: var(--inactive-color);
    }

    ul.tab-list a:focus {
      outline: none;
    }

    ul.tab-list a:hover {
      background-color: var(--hover-color);
    }

    ul.tab-list a:target {
      background-color: var(--active-color);
    }

    ul.tab-list button {
      display: block;
      padding: 5px 10px;
      border: none;
      color: var(--font-color);
      background-color: var(--inactive-color);
    }

    ul.tab-list button:focus {
      outline: none;
    }

    ul.tab-list button:hover {
      background-color: var(--hover-color);
    }

    dialog#help {
      background: var(--background-color);
      color: var(--font-color);
      border: none;
    }
    dialog#help button {
      background: var(--inactive-color);
      color: var(--font-color);
      float: inline-end;
      padding: 5px 10px;
      border: none;
    }
    dialog#help button:hover {
      background: var(--hover-color);
    }
  </style>
</head>
<body>
  <ul class="tab-list">
    <li><button onclick="document.querySelector('#help').showModal()">?</button></li>
    <li><a id="D2H" href="#D2H">Dipole(2) H</a></li>
    <li><a id="D2V" href="#D2V">Dipole(2) V</a></li>
    <li><a id="D3H" href="#D3H">Dipole(3) H</a></li>
    <li><a id="D3V" href="#D3V">Dipole(3) V</a></li>
    <li><a id="Q3" href="#Q3">Quadrapole(3)</a></li>
    <li><a id="DD" href="#DD">Dipole(2)^2</a></li>
  </ul>
  <canvas id="main" width="600" height="400"></canvas>
  <dialog id="help">
    <h2>How To Play</h2>
    <p><b>Left/Right-click</b> to twist the puzzle.</p>
    <p>Use <b>wheel</b> to rotate rifts, or <b>drag</b> them on the turning point.</p>
    <p><b>Middle-click</b> to change active layer.</p>
    <p><b>Shift-drag</b> to draw on the puzzle.</p>

    <!-- <p>Ctrl-click to select a piece of the puzzle.</p>
    <p>Press "c" to open command palette.</p> -->

    <br/>
    <a class="github-button" href="https://github.com/worldmaker18349276/twisty-space-rift" data-color-scheme="no-preference: light; light: light; dark: dark;" data-size="large" aria-label="Star worldmaker18349276/twisty-space-rift on GitHub">Star</a>
    <button autofocus onclick="document.querySelector('#help').close()">Close</button>
  </dialog>
</body>
</html>